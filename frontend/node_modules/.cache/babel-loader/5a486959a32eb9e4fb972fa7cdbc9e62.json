{"ast":null,"code":"import { useStore } from 'vuex';\nimport { addBuy } from '@/api/addBuy'; // eslint-disable-next-line\n\nimport { ElMessage, ElMessageBox } from 'element-plus';\nimport { ref } from \"vue\";\nexport default {\n  setup(__props, {\n    expose\n  }) {\n    expose();\n    const purchaseForm = ref({\n      products: [{\n        product_name: '',\n        product_version: '',\n        quantity: '',\n        price: ''\n      }],\n      note: '',\n      deposit: '',\n      buy_time: ''\n    });\n\n    const addbuy = async () => {\n      // console.log(form)\n      // store.dispatch('app/listItem', form.value)\n      addBuy(purchaseForm.value, localStorage.getItem('token')).then(() => {\n        // console.log('get returned' + res)\n        ElMessageBox.alert('提交成功！', {\n          confirmButtonText: 'OK',\n          callback: () => {\n            purchaseForm.value = {\n              products: [{\n                product_name: '',\n                product_version: '',\n                quantity: '',\n                price: ''\n              }],\n              note: '',\n              deposit: '',\n              buy_time: ''\n            };\n            ElMessage({\n              type: 'info',\n              message: '已更新列表'\n            });\n          }\n        });\n      }).catch(err => {\n        alert(err);\n      });\n    };\n\n    const addProduct = async () => {\n      purchaseForm.value.products.push({\n        product_name: '',\n        product_version: '',\n        quantity: '',\n        price: '',\n        key: Date.now()\n      });\n    };\n\n    const removeProduct = product => {\n      var index = purchaseForm.value.products.indexOf(product);\n\n      if (index !== -1) {\n        purchaseForm.value.products.splice(index, 1);\n      }\n    };\n\n    const resetForm = async () => {\n      purchaseForm.value = {\n        products: [{\n          product_name: '',\n          product_version: '',\n          quantity: '',\n          price: ''\n        }],\n        note: '',\n        deposit: '',\n        buy_time: ''\n      };\n    }; // listItem\n    // eslint-disable-next-line\n\n\n    const store = useStore();\n    const itemsData = ref([]);\n    const __returned__ = {\n      purchaseForm,\n      addbuy,\n      addProduct,\n      removeProduct,\n      resetForm,\n      store,\n      itemsData,\n      useStore,\n      addBuy,\n      ElMessage,\n      ElMessageBox,\n      ref\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n\n};","map":{"version":3,"mappings":"AAsEA,SAASA,QAAT,QAAyB,MAAzB;AACA,SAASC,MAAT,QAAuB,cAAvB,C,CACA;;AACA,SAASC,SAAT,EAAoBC,YAApB,QAAwC,cAAxC;AACA,SAAQC,GAAR,QAAkB,KAAlB;;;;;;IAEA,MAAMC,YAAY,GAAGD,GAAG,CAAC;MACvBE,QAAQ,EAAE,CAAC;QACTC,YAAY,EAAE,EADL;QAETC,eAAe,EAAE,EAFR;QAGTC,QAAQ,EAAE,EAHD;QAITC,KAAK,EAAE;MAJE,CAAD,CADa;MAOvBC,IAAI,EAAE,EAPiB;MAQvBC,OAAO,EAAE,EARc;MASvBC,QAAQ,EAAE;IATa,CAAD,CAAxB;;IAYA,MAAMC,MAAM,GAAG,YAAY;MACzB;MACA;MACAb,MAAM,CAACI,YAAY,CAACU,KAAd,EAAqBC,YAAY,CAACC,OAAb,CAAqB,OAArB,CAArB,CAAN,CAA0DC,IAA1D,CAA+D,MAAM;QACnE;QACAf,YAAY,CAACgB,KAAb,CAAmB,OAAnB,EAA4B;UAC1BC,iBAAiB,EAAE,IADO;UAE1BC,QAAQ,EAAE,MAAM;YACdhB,YAAY,CAACU,KAAb,GAAqB;cACnBT,QAAQ,EAAE,CAAC;gBACTC,YAAY,EAAE,EADL;gBAETC,eAAe,EAAE,EAFR;gBAGTC,QAAQ,EAAE,EAHD;gBAITC,KAAK,EAAE;cAJE,CAAD,CADS;cAOnBC,IAAI,EAAE,EAPa;cAQnBC,OAAO,EAAE,EARU;cASnBC,QAAQ,EAAE;YATS,CAArB;YAWAX,SAAS,CAAC;cACRoB,IAAI,EAAE,MADE;cAERC,OAAO,EAAE;YAFD,CAAD,CAAT;UAID;QAlByB,CAA5B;MAoBD,CAtBD,EAsBGC,KAtBH,CAsBUC,GAAD,IAAS;QAChBN,KAAK,CAACM,GAAD,CAAL;MACD,CAxBD;IAyBD,CA5BD;;IA8BA,MAAMC,UAAU,GAAG,YAAU;MAC3BrB,YAAY,CAACU,KAAb,CAAmBT,QAAnB,CAA4BqB,IAA5B,CAAiC;QAC/BpB,YAAY,EAAE,EADiB;QAE/BC,eAAe,EAAE,EAFc;QAG/BC,QAAQ,EAAE,EAHqB;QAI/BC,KAAK,EAAE,EAJwB;QAK/BkB,GAAG,EAAEC,IAAI,CAACC,GAAL;MAL0B,CAAjC;IAMG,CAPL;;IASA,MAAMC,aAAa,GAAIC,OAAD,IAAa;MACjC,IAAIC,KAAK,GAAG5B,YAAY,CAACU,KAAb,CAAmBT,QAAnB,CAA4B4B,OAA5B,CAAoCF,OAApC,CAAZ;;MACA,IAAIC,KAAK,KAAK,CAAC,CAAf,EAAkB;QAChB5B,YAAY,CAACU,KAAb,CAAmBT,QAAnB,CAA4B6B,MAA5B,CAAmCF,KAAnC,EAA0C,CAA1C;MACD;IACF,CALD;;IAOA,MAAMG,SAAS,GAAG,YAAU;MAC1B/B,YAAY,CAACU,KAAb,GAAqB;QACnBT,QAAQ,EAAE,CAAC;UACTC,YAAY,EAAE,EADL;UAETC,eAAe,EAAE,EAFR;UAGTC,QAAQ,EAAE,EAHD;UAITC,KAAK,EAAE;QAJE,CAAD,CADS;QAOnBC,IAAI,EAAE,EAPa;QAQnBC,OAAO,EAAE,EARU;QASnBC,QAAQ,EAAE;MATS,CAArB;IAWD,CAZD,EAcA;IACA;;;IACA,MAAMwB,KAAK,GAAGrC,QAAQ,EAAtB;IACA,MAAMsC,SAAS,GAAGlC,GAAG,CAAC,EAAD,CAArB","names":["useStore","addBuy","ElMessage","ElMessageBox","ref","purchaseForm","products","product_name","product_version","quantity","price","note","deposit","buy_time","addbuy","value","localStorage","getItem","then","alert","confirmButtonText","callback","type","message","catch","err","addProduct","push","key","Date","now","removeProduct","product","index","indexOf","splice","resetForm","store","itemsData"],"sources":["/Users/alzhong/Personal/Projects/FamilyCareInventory/frontend/src/views/MainView/PurchaseView/PurchaseView.vue"],"sourcesContent":["<template>\n  <div class=\"page-title\">\n    <h1>添加采购</h1>\n    <hr style=\"width:50%;text-align:left;margin-left:0\">\n  </div>\n  <div class=\"list-form\">\n    <el-form :model=\"purchaseForm\" ref=\"form\" label-width=\"100px\">\n      <el-form-item prop=\"note\" label=\"采购抬头\">\n        <el-input v-model=\"purchaseForm.note\" class=\"item-input\"></el-input>\n      </el-form-item>\n      <el-form-item prop=\"deposit\" label=\"采购订金\">\n        <el-input v-model=\"purchaseForm.deposit\" class=\"item-input\"></el-input>\n      </el-form-item>\n      <el-form-item label=\"采购日期\" prop=\"buy_time\">\n      <el-date-picker\n          type=\"date\" placeholder=\"选择日期\" v-model=\"purchaseForm.buy_time\">\n      </el-date-picker>\n      </el-form-item>\n      <el-form-item v-for=\"(product, index) in purchaseForm.products\"\n                    :label=\"'商品' + index\"\n                    :key=\"product.key\"\n                    :prop=\"'商品.' + index + '.product_name'\">\n        <el-col :span=\"11\">\n        <el-input v-model=\"product.product_name\" placeholder=\"品名\" style=\"width: 100%;\"></el-input>\n        </el-col>\n          <el-col>\n          <el-input v-model=\"product.product_version\" placeholder=\"型号\" style=\"width: 100%;\"></el-input>\n          </el-col>\n        <el-col :span=\"11\">\n          <el-input v-model=\"product.quantity\" placeholder=\"数量\" style=\"width: 100%;\"></el-input>\n        </el-col>\n        <el-col :span=\"11\">\n          <el-input v-model=\"product.price\" placeholder=\"单价\" style=\"width: 100%;\"></el-input>\n        </el-col>\n        <el-button @click.prevent=\"removeProduct(product)\">删除</el-button>\n        </el-form-item>\n      <el-form-item>\n        <el-button type=\"primary\" @click=\"addbuy\" class=\"item-button\">提交</el-button>\n        <el-button @click=\"addProduct\" class=\"item-button\">新增商品</el-button>\n        <el-button @click=\"resetForm\" class=\"item-button\">重置</el-button>\n      </el-form-item>\n    </el-form>\n  </div>\n  <br/>\n  <br/>\n  <br/>\n  <div class=\"page-title\">\n    <h1>采购列表</h1>\n    <hr style=\"width:50%;text-align:left;margin-left:0\">\n  </div>\n\n  <div class=\"items-container\">\n    <el-table :data=\"itemsData\" style=\"width: 100%\" table-layout: auto>\n      <el-table-column prop=\"product_name\" label=\"品名\"/>\n      <el-table-column prop=\"product_version\" label=\"型号\"/>\n      <el-table-column prop=\"inventory\" label=\"库存量\"/>\n      <el-table-column prop=\"created_time\" label=\"创建时间\"/>\n      <el-table-column fixed=\"right\" label=\"操作\">\n        <template #default=\"{ row }\">\n          <el-select v-model=\"itemsData[row.productId]\" class=\"m-2\" placeholder=\"Select\" size=\"small\"\n                     @change=\"handleDelete(row)\">\n            <el-option label=\"删除\" value=0></el-option>\n          </el-select>\n        </template>\n      </el-table-column>\n    </el-table>\n  </div>\n</template>\n\n<script setup>\nimport { useStore } from 'vuex'\nimport { addBuy } from '@/api/addBuy'\n// eslint-disable-next-line\nimport { ElMessage, ElMessageBox } from 'element-plus'\nimport {ref} from \"vue\";\n\nconst purchaseForm = ref({\n  products: [{\n    product_name: '',\n    product_version: '',\n    quantity: '',\n    price: ''\n  }],\n  note: '',\n  deposit: '',\n  buy_time: ''\n})\n\nconst addbuy = async () => {\n  // console.log(form)\n  // store.dispatch('app/listItem', form.value)\n  addBuy(purchaseForm.value, localStorage.getItem('token')).then(() => {\n    // console.log('get returned' + res)\n    ElMessageBox.alert('提交成功！', {\n      confirmButtonText: 'OK',\n      callback: () => {\n        purchaseForm.value = {\n          products: [{\n            product_name: '',\n            product_version: '',\n            quantity: '',\n            price: ''\n          }],\n          note: '',\n          deposit: '',\n          buy_time: ''\n        }\n        ElMessage({\n          type: 'info',\n          message: '已更新列表'\n        })\n      }\n    })\n  }).catch((err) => {\n    alert(err)\n  })\n}\n\nconst addProduct = async() =>{\n  purchaseForm.value.products.push({\n    product_name: '',\n    product_version: '',\n    quantity: '',\n    price: '',\n    key: Date.now()\n  })}\n\nconst removeProduct = (product) => {\n  var index = purchaseForm.value.products.indexOf(product)\n  if (index !== -1) {\n    purchaseForm.value.products.splice(index, 1)\n  }\n}\n\nconst resetForm = async() =>{\n  purchaseForm.value = {\n    products: [{\n      product_name: '',\n      product_version: '',\n      quantity: '',\n      price: ''\n    }],\n    note: '',\n    deposit: '',\n    buy_time: ''\n  }\n}\n\n// listItem\n// eslint-disable-next-line\nconst store = useStore()\nconst itemsData = ref([])\n\n</script>\n\n<style scoped lang=\"scss\">\n\n.list-form {\n  margin-left: 350px;\n}\n\n.page-title {\n  font-size: 20px;\n  text-align: left;\n  margin-left: 300px;\n  margin-bottom: 20px;\n}\n\n.item-input {\n  width: 400px;\n}\n\n.item-button {\n  margin-left: 10px;\n  margin-top: 20px;\n}\n\n.items-container {\n  margin-left: 300px;\n  width: 1000px;\n}\n\n.page-title {\n  font-size: 20px;\n  text-align: left;\n  margin-left: 300px;\n  margin-bottom: 20px;\n}\n</style>\n"]},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import { onMounted, ref } from 'vue';\nimport { myInventory } from '@/api/myInventory';\nimport { addInventory } from '@/api/addInventory';\nimport { deleteInventory } from \"@/api/deleteInventory\";\nimport { ElMessage, ElMessageBox } from 'element-plus';\nexport default {\n  setup(__props, {\n    expose\n  }) {\n    expose();\n    const rules = ref({\n      product_name: [{\n        required: true,\n        message: '请输入品名',\n        trigger: 'blur'\n      }],\n      product_version: [{\n        required: true,\n        message: '请输入型号',\n        trigger: 'blur'\n      }],\n      inventory: [{\n        required: true,\n        message: '请输入库存',\n        trigger: 'blur'\n      }]\n    });\n    const form = ref({\n      product_name: '',\n      product_version: '',\n      inventory: ''\n    });\n    const itemsData = ref([]);\n    onMounted(async () => {\n      const y = await myInventory(localStorage.getItem('token'));\n      itemsData.value = y;\n    });\n\n    const initProductData = async () => {\n      itemsData.value = [];\n      itemsData.value = await myInventory(localStorage.getItem('token'));\n    };\n\n    const handleList = async () => {\n      addInventory(form.value, localStorage.getItem('token')).then(() => {\n        ElMessageBox.alert('提交成功！', {\n          confirmButtonText: 'OK',\n          callback: () => {\n            setTimeout(initProductData, 1);\n            setTimeout(resetInventoryForm, 1);\n            ElMessage({\n              type: 'info',\n              message: '已更新列表'\n            });\n          }\n        });\n      }).catch(err => {\n        alert(err);\n      });\n      setTimeout(initProductData, 1);\n    };\n\n    const handleDelete = async row => {\n      console.log(row);\n      deleteInventory({\n        token: localStorage.getItem('token'),\n        productId: row.productId\n      });\n      ElMessage({\n        type: 'info',\n        message: '已删除'\n      });\n      setTimeout(initProductData, 1);\n    };\n\n    const resetInventoryForm = async () => {\n      form.value = {\n        product_name: '',\n        product_version: '',\n        inventory: ''\n      };\n    };\n\n    const focusOnNextItem = nextItemId => {\n      var nextItem = document.getElementById(nextItemId);\n      nextItem.focus();\n    };\n\n    const __returned__ = {\n      rules,\n      form,\n      itemsData,\n      initProductData,\n      handleList,\n      handleDelete,\n      resetInventoryForm,\n      focusOnNextItem,\n      onMounted,\n      ref,\n      myInventory,\n      addInventory,\n      deleteInventory,\n      ElMessage,\n      ElMessageBox\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n\n};","map":{"version":3,"mappings":"AA+CA,SAASA,SAAT,EAAoBC,GAApB,QAA+B,KAA/B;AACA,SAASC,WAAT,QAA4B,mBAA5B;AACA,SAASC,YAAT,QAA6B,oBAA7B;AACA,SAAQC,eAAR,QAA8B,uBAA9B;AACA,SAASC,SAAT,EAAoBC,YAApB,QAAwC,cAAxC;;;;;;IAEA,MAAMC,KAAK,GAAGN,GAAG,CAAC;MAChBO,YAAY,EAAE,CACZ;QACEC,QAAQ,EAAE,IADZ;QAEEC,OAAO,EAAE,OAFX;QAGEC,OAAO,EAAE;MAHX,CADY,CADE;MAQhBC,eAAe,EAAE,CACf;QACEH,QAAQ,EAAE,IADZ;QAEEC,OAAO,EAAE,OAFX;QAGEC,OAAO,EAAE;MAHX,CADe,CARD;MAehBE,SAAS,EAAE,CACT;QACEJ,QAAQ,EAAE,IADZ;QAEEC,OAAO,EAAE,OAFX;QAGEC,OAAO,EAAE;MAHX,CADS;IAfK,CAAD,CAAjB;IAwBA,MAAMG,IAAI,GAAGb,GAAG,CAAC;MACfO,YAAY,EAAE,EADC;MAEfI,eAAe,EAAE,EAFF;MAGfC,SAAS,EAAE;IAHI,CAAD,CAAhB;IAMA,MAAME,SAAS,GAAGd,GAAG,CAAC,EAAD,CAArB;IACAD,SAAS,CAAC,YAAY;MACpB,MAAMgB,CAAC,GAAG,MAAMd,WAAW,CAACe,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAD,CAA3B;MACAH,SAAS,CAACI,KAAV,GAAkBH,CAAlB;IACD,CAHQ,CAAT;;IAKA,MAAMI,eAAe,GAAG,YAAY;MAClCL,SAAS,CAACI,KAAV,GAAkB,EAAlB;MACAJ,SAAS,CAACI,KAAV,GAAkB,MAAMjB,WAAW,CAACe,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAD,CAAnC;IACD,CAHD;;IAKA,MAAMG,UAAU,GAAG,YAAY;MAC7BlB,YAAY,CAACW,IAAI,CAACK,KAAN,EAAaF,YAAY,CAACC,OAAb,CAAqB,OAArB,CAAb,CAAZ,CAAwDI,IAAxD,CAA6D,MAAM;QACjEhB,YAAY,CAACiB,KAAb,CAAmB,OAAnB,EAA4B;UAC1BC,iBAAiB,EAAE,IADO;UAE1BC,QAAQ,EAAE,MAAM;YACdC,UAAU,CAACN,eAAD,EAAkB,CAAlB,CAAV;YACAM,UAAU,CAACC,kBAAD,EAAqB,CAArB,CAAV;YACAtB,SAAS,CAAC;cACRuB,IAAI,EAAE,MADE;cAERlB,OAAO,EAAE;YAFD,CAAD,CAAT;UAID;QATyB,CAA5B;MAWD,CAZD,EAYGmB,KAZH,CAYUC,GAAD,IAAS;QAChBP,KAAK,CAACO,GAAD,CAAL;MACD,CAdD;MAeAJ,UAAU,CAACN,eAAD,EAAkB,CAAlB,CAAV;IACD,CAjBD;;IAmBA,MAAMW,YAAY,GAAG,MAAOC,GAAP,IAAe;MAClCC,OAAO,CAACC,GAAR,CAAYF,GAAZ;MACA5B,eAAe,CAAC;QACd+B,KAAK,EAAElB,YAAY,CAACC,OAAb,CAAqB,OAArB,CADO;QAEdkB,SAAS,EAAEJ,GAAG,CAACI;MAFD,CAAD,CAAf;MAIA/B,SAAS,CAAC;QACRuB,IAAI,EAAE,MADE;QAERlB,OAAO,EAAE;MAFD,CAAD,CAAT;MAIAgB,UAAU,CAACN,eAAD,EAAkB,CAAlB,CAAV;IACD,CAXD;;IAaA,MAAMO,kBAAkB,GAAG,YAAW;MACpCb,IAAI,CAACK,KAAL,GAAa;QACXX,YAAY,EAAE,EADH;QAEXI,eAAe,EAAE,EAFN;QAGXC,SAAS,EAAE;MAHA,CAAb;IAKD,CAND;;IAQA,MAAMwB,eAAe,GAAIC,UAAD,IAAgB;MACtC,IAAIC,QAAQ,GAAGC,QAAQ,CAACC,cAAT,CAAwBH,UAAxB,CAAf;MACAC,QAAQ,CAACG,KAAT;IACD,CAHD","names":["onMounted","ref","myInventory","addInventory","deleteInventory","ElMessage","ElMessageBox","rules","product_name","required","message","trigger","product_version","inventory","form","itemsData","y","localStorage","getItem","value","initProductData","handleList","then","alert","confirmButtonText","callback","setTimeout","resetInventoryForm","type","catch","err","handleDelete","row","console","log","token","productId","focusOnNextItem","nextItemId","nextItem","document","getElementById","focus"],"sources":["/Users/alzhong/Personal/Projects/FamilyCareInventory/frontend/src/views/MainView/InventoryView/InventoryView.vue"],"sourcesContent":["<template>\n  <div class=\"page-title\">\n    <h1>添加库存</h1>\n    <hr style=\"width:50%;text-align:left;margin-left:0\">\n  </div>\n  <div class=\"list-form\">\n    <el-form :model=\"form\" ref=form label-width=\"100px\" :rules=\"rules\">\n      <el-form-item label=\"品名\" prop=\"product_name\">\n        <el-input class=\"item-input\" size=\"large\" v-model=\"form.product_name\" @keyup.enter=\"focusOnNextItem('pv')\"/>\n      </el-form-item>\n      <el-form-item label=\"型号\" prop=\"product_version\">\n        <el-input class=\"item-input\" size=\"large\" v-model=\"form.product_version\" @keyup.enter=\"focusOnNextItem('inv')\" id=\"pv\"/>\n      </el-form-item>\n      <el-form-item label=\"库存\" prop=\"inventory\">\n        <el-input class=\"item-input\" size=\"large\" v-model=\"form.inventory\" @keyup.enter=\"handleList\" id=\"inv\"/>\n      </el-form-item>\n      <el-form-item>\n        <el-button type=\"primary\" @click=\"handleList\" class=\"item-button\">提交</el-button>\n      </el-form-item>\n    </el-form>\n  </div>\n  <br/>\n  <br/>\n  <br/>\n  <div class=\"page-title\">\n    <h1>现有库存</h1>\n    <hr style=\"width:50%;text-align:left;margin-left:0\">\n  </div>\n  <div class=\"items-container\">\n    <el-table :data=\"itemsData\" style=\"width: 100%\" table-layout: auto>\n      <el-table-column prop=\"product_name\" label=\"品名\"/>\n      <el-table-column prop=\"product_version\" label=\"型号\"/>\n      <el-table-column prop=\"inventory\" label=\"库存量\"/>\n      <el-table-column prop=\"created_time\" label=\"创建时间\"/>\n      <el-table-column fixed=\"right\" label=\"操作\">\n        <template #default=\"{ row }\">\n          <el-select v-model=\"itemsData[row.productId]\" class=\"m-2\" placeholder=\"Select\" size=\"small\"\n                     @change=\"handleDelete(row)\">\n            <el-option label=\"删除\" value=0></el-option>\n          </el-select>\n        </template>\n      </el-table-column>\n    </el-table>\n  </div>\n</template>\n\n<script setup>\nimport { onMounted, ref } from 'vue'\nimport { myInventory } from '@/api/myInventory'\nimport { addInventory } from '@/api/addInventory'\nimport {deleteInventory} from \"@/api/deleteInventory\";\nimport { ElMessage, ElMessageBox } from 'element-plus'\n\nconst rules = ref({\n  product_name: [\n    {\n      required: true,\n      message: '请输入品名',\n      trigger: 'blur'\n    }\n  ],\n  product_version: [\n    {\n      required: true,\n      message: '请输入型号',\n      trigger: 'blur'\n    }\n  ],\n  inventory: [\n    {\n      required: true,\n      message: '请输入库存',\n      trigger: 'blur'\n    }\n  ]\n})\n\nconst form = ref({\n  product_name: '',\n  product_version: '',\n  inventory: ''\n})\n\nconst itemsData = ref([])\nonMounted(async () => {\n  const y = await myInventory(localStorage.getItem('token'))\n  itemsData.value = y\n})\n\nconst initProductData = async () => {\n  itemsData.value = []\n  itemsData.value = await myInventory(localStorage.getItem('token'))\n}\n\nconst handleList = async () => {\n  addInventory(form.value, localStorage.getItem('token')).then(() => {\n    ElMessageBox.alert('提交成功！', {\n      confirmButtonText: 'OK',\n      callback: () => {\n        setTimeout(initProductData, 1)\n        setTimeout(resetInventoryForm, 1)\n        ElMessage({\n          type: 'info',\n          message: '已更新列表'\n        })\n      }\n    })\n  }).catch((err) => {\n    alert(err)\n  })\n  setTimeout(initProductData, 1)\n}\n\nconst handleDelete = async (row) => {\n  console.log(row)\n  deleteInventory({\n    token: localStorage.getItem('token'),\n    productId: row.productId,\n  })\n  ElMessage({\n    type: 'info',\n    message: '已删除'\n  })\n  setTimeout(initProductData, 1)\n}\n\nconst resetInventoryForm = async() => {\n  form.value = {\n    product_name: '',\n    product_version: '',\n    inventory: ''\n  }\n}\n\nconst focusOnNextItem = (nextItemId) => {\n  var nextItem = document.getElementById(nextItemId)\n  nextItem.focus()\n}\n</script>\n\n<style scoped lang=\"scss\">\n\n.list-form {\n  margin-left: 350px;\n}\n\n.page-title {\n  font-size: 20px;\n  text-align: left;\n  margin-left: 300px;\n  margin-bottom: 20px;\n}\n\n.item-input {\n  width: 400px;\n}\n\n.item-button {\n  margin-left: 10px;\n  margin-top: 20px;\n}\n\n.items-container {\n  margin-left: 300px;\n  width: 1000px;\n}\n\n.page-title {\n  font-size: 20px;\n  text-align: left;\n  margin-left: 300px;\n  margin-bottom: 20px;\n}\n</style>\n"]},"metadata":{},"sourceType":"module"}
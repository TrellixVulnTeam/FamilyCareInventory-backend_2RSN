{"ast":null,"code":"import \"core-js/modules/es.error.cause.js\";\nimport { onMounted, ref } from 'vue';\nimport { useStore } from 'vuex';\nimport { myItems } from '@/api/myProduct';\nimport { listItem } from '@/api/listProduct';\nimport { deleteProduct } from \"@/api/deleteProduct\"; // eslint-disable-next-line\n\nimport { ElMessage, ElMessageBox } from 'element-plus';\nexport default {\n  setup(__props, {\n    expose\n  }) {\n    expose();\n    const form = ref();\n    const blankForm = {\n      product_name: '',\n      product_version: '',\n      inventory: ''\n    };\n    form.value = blankForm;\n\n    const initProductData = async () => {\n      itemsData.value = [];\n      itemsData.value = await myItems(localStorage.getItem('token'));\n    }; // listItem\n    // eslint-disable-next-line\n\n\n    const store = useStore();\n\n    const handleList = async () => {\n      // console.log(form)\n      // store.dispatch('app/listItem', form.value)\n      await initProductData();\n      listItem(form.value, localStorage.getItem('token')).then(() => {\n        // console.log('get returned' + res)\n        ElMessageBox.alert('提交成功！', {\n          confirmButtonText: 'OK',\n          callback: () => {\n            form.value = {\n              product_name: '',\n              product_version: '',\n              inventory: ''\n            };\n            ElMessage({\n              type: 'info',\n              message: '已更新列表'\n            });\n          }\n        });\n      }).catch(err => {\n        alert(err);\n      });\n      setTimeout(initProductData, 1);\n    };\n\n    const itemsData = ref([]);\n    onMounted(async () => {\n      const y = await myItems(localStorage.getItem('token'));\n      itemsData.value = y;\n    });\n\n    const handleDelete = async row => {\n      console.log(row);\n      deleteProduct({\n        token: localStorage.getItem('token'),\n        productId: row.productId\n      });\n      ElMessage({\n        type: 'info',\n        message: '已删除'\n      });\n      setTimeout(initProductData, 1);\n    };\n\n    const rulesForm = ref({\n      product_name: [{\n        required: true,\n        message: '请输入品名',\n        trigger: 'blur'\n      }],\n      product_version: [{\n        required: true,\n        message: '请输入型号',\n        trigger: 'blur'\n      }],\n      inventory: [{\n        validator: checkInt,\n        trigger: 'blur'\n      }]\n    });\n\n    var checkInt = (rule, value, callback) => {\n      if (!value) {\n        return callback(new Error('库存不能为空'));\n      }\n\n      setTimeout(() => {\n        if (!Number.isInteger(value)) {\n          callback(new Error('请输入数字值'));\n        } else callback();\n      }, 500);\n    };\n\n    const focusOnPV = () => {\n      var pv = document.getElementById('pv');\n      pv.focus();\n    };\n\n    const focusOnInv = () => {\n      var inv = document.getElementById('inv');\n      inv.focus();\n    };\n\n    const __returned__ = {\n      form,\n      blankForm,\n      initProductData,\n      store,\n      handleList,\n      itemsData,\n      handleDelete,\n      rulesForm,\n      checkInt,\n      focusOnPV,\n      focusOnInv,\n      onMounted,\n      ref,\n      useStore,\n      myItems,\n      listItem,\n      deleteProduct,\n      ElMessage,\n      ElMessageBox\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n\n};","map":{"version":3,"mappings":"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","names":["onMounted","ref","useStore","myItems","listItem","deleteProduct","ElMessage","ElMessageBox","form","blankForm","product_name","product_version","inventory","value","initProductData","itemsData","localStorage","getItem","store","handleList","then","alert","confirmButtonText","callback","type","message","catch","err","setTimeout","y","handleDelete","row","console","log","token","productId","rulesForm","required","trigger","validator","checkInt","rule","Error","Number","isInteger","focusOnPV","pv","document","getElementById","focus","focusOnInv","inv"],"sources":["/Users/alzhong/Personal/Projects/FamilyCareInventory/frontend/src/views/MainView/InventoryView/InventoryView.vue"],"sourcesContent":["<template>\n  <div class=\"page-title\">\n    <h1>添加库存</h1>\n    <hr style=\"width:50%;text-align:left;margin-left:0\">\n  </div>\n  <div class=\"list-form\">\n    <el-form :model=\"form\" label-width=\"100px\" :rules=\"rulesForm\">\n      <el-form-item label=\"品名\">\n        <el-input class=\"item-input\" size=\"large\" v-model=\"form.product_name\" @keyup.enter=\"focusOnPV\"/>\n      </el-form-item>\n      <el-form-item label=\"型号\">\n        <el-input class=\"item-input\" size=\"large\" v-model=\"form.product_version\" @keyup.enter=\"focusOnInv\" id=\"pv\"/>\n      </el-form-item>\n      <el-form-item label=\"库存\">\n        <el-input class=\"item-input\" size=\"large\" v-model=\"form.inventory\" id=\"inv\" @keyup.enter=\"handleList\"/>\n      </el-form-item>\n      <el-form-item>\n        <el-button type=\"primary\" @click=\"handleList\" class=\"item-button\">提交</el-button>\n      </el-form-item>\n    </el-form>\n  </div>\n  <br/>\n  <br/>\n  <br/>\n  <div class=\"page-title\">\n    <h1>现有库存</h1>\n    <hr style=\"width:50%;text-align:left;margin-left:0\">\n  </div>\n\n  <div class=\"items-container\">\n    <el-table :data=\"itemsData\" style=\"width: 100%\" table-layout: auto>\n      <el-table-column prop=\"product_name\" label=\"品名\"/>\n      <el-table-column prop=\"product_version\" label=\"型号\"/>\n      <el-table-column prop=\"inventory\" label=\"库存量\"/>\n      <el-table-column prop=\"created_time\" label=\"创建时间\"/>\n      <el-table-column fixed=\"right\" label=\"操作\">\n        <template #default=\"{ row }\">\n          <el-select v-model=\"itemsData[row.productId]\" class=\"m-2\" placeholder=\"Select\" size=\"small\"\n                     @change=\"handleDelete(row)\">\n            <el-option label=\"删除\" value=0></el-option>\n          </el-select>\n        </template>\n      </el-table-column>\n    </el-table>\n  </div>\n</template>\n\n<script setup>\nimport { onMounted, ref } from 'vue'\nimport { useStore } from 'vuex'\nimport { myItems } from '@/api/myProduct'\nimport { listItem } from '@/api/listProduct'\nimport {deleteProduct} from \"@/api/deleteProduct\";\n// eslint-disable-next-line\nimport { ElMessage, ElMessageBox } from 'element-plus'\n\nconst form = ref()\nconst blankForm = {\n  product_name: '',\n  product_version: '',\n  inventory: ''\n}\nform.value = blankForm\nconst initProductData = async () => {\n  itemsData.value = []\n  itemsData.value = await myItems(localStorage.getItem('token'))\n}\n\n// listItem\n// eslint-disable-next-line\nconst store = useStore()\nconst handleList = async () => {\n  // console.log(form)\n  // store.dispatch('app/listItem', form.value)\n  await initProductData()\n  listItem(form.value, localStorage.getItem('token')).then(() => {\n    // console.log('get returned' + res)\n    ElMessageBox.alert('提交成功！', {\n      confirmButtonText: 'OK',\n      callback: () => {\n        form.value = {\n          product_name: '',\n          product_version: '',\n          inventory: ''\n        }\n        ElMessage({\n          type: 'info',\n          message: '已更新列表'\n        })\n      }\n    })\n  }).catch((err) => {\n    alert(err)\n  })\n  setTimeout(initProductData, 1)\n}\nconst itemsData = ref([])\nonMounted(async () => {\n  const y = await myItems(localStorage.getItem('token'))\n  itemsData.value = y\n})\n\nconst handleDelete = async (row) => {\n  console.log(row)\n  deleteProduct({\n    token: localStorage.getItem('token'),\n    productId: row.productId,\n  })\n  ElMessage({\n    type: 'info',\n    message: '已删除'\n  })\n  setTimeout(initProductData, 1)\n}\n\nconst rulesForm = ref({\n  product_name: [\n    {\n      required: true,\n      message: '请输入品名',\n      trigger: 'blur'\n    }\n  ],\n  product_version: [\n    {\n      required: true,\n      message: '请输入型号',\n      trigger: 'blur'\n    }\n  ],\n  inventory: [\n    {\n      validator: checkInt,\n      trigger: 'blur'\n  }\n]\n})\nvar checkInt = (rule, value, callback) => {\n  if (!value) {\n    return callback(new Error('库存不能为空'));\n  }\n  setTimeout(() => {\n    if (!Number.isInteger(value)) {\n      callback(new Error('请输入数字值'));\n    } else\n        callback();\n  }, 500);\n};\nconst focusOnPV = () => {\n  var pv = document.getElementById('pv')\n  pv.focus()\n}\nconst focusOnInv = () => {\n  var inv = document.getElementById('inv')\n  inv.focus()\n}\n</script>\n\n<style scoped lang=\"scss\">\n\n.list-form {\n  margin-left: 350px;\n}\n\n.page-title {\n  font-size: 20px;\n  text-align: left;\n  margin-left: 300px;\n  margin-bottom: 20px;\n}\n\n.item-input {\n  width: 400px;\n}\n\n.item-button {\n  margin-left: 10px;\n  margin-top: 20px;\n}\n\n.items-container {\n  margin-left: 300px;\n  width: 1000px;\n}\n\n.page-title {\n  font-size: 20px;\n  text-align: left;\n  margin-left: 300px;\n  margin-bottom: 20px;\n}\n</style>\n"]},"metadata":{},"sourceType":"module"}
{"ast":null,"code":"import { Check, Close } from '@element-plus/icons-vue';\n/* eslint-disable */\n\nimport { computed, onBeforeMount, onMounted, ref } from 'vue'; // import { useStore } from 'vuex'\n\nimport { mainPage } from '@/api/main_page';\nimport { ElDialog, ElMessage, ElMessageBox } from 'element-plus';\nimport { aorSwapForm } from '@/api/aorSwapForm';\nimport { acceptSwap } from '@/api/acceptSwap';\nimport { rateSwapForm } from '@/api/rateSwapForm';\nimport { rateSwap } from '@/api/rateSwap';\nimport router from '@/router';\nimport { rejectSwap } from '@/api/rejectSwap';\nimport { itemDetail } from '@/api/itemDetail'; // const store = useStore()\n\nexport default {\n  setup(__props, {\n    expose\n  }) {\n    expose();\n    const strName = ref('');\n    const swapData = ref([]);\n    const rateData = ref([]);\n    let dialogUnacceptedVisible = ref(false);\n    let dialogUnratedVisible = ref(false);\n    onMounted(async () => {\n      await initMainPage();\n    });\n\n    const initMainPage = async () => {\n      let x = await mainPage(localStorage.getItem('token'));\n      strName.value = x;\n    };\n\n    const initSwapData = async () => {\n      swapData.value = [];\n      swapData.value = await aorSwapForm(localStorage.getItem('token')); // console.log('swap data len is' + swapData.value.length)\n\n      console.log(swapData.value);\n    };\n\n    const rateValue = ref([]);\n\n    const initRateFrom = async () => {\n      const res = await rateSwapForm(localStorage.getItem('token'));\n      rateValue.value = [];\n      rateData.value = res;\n    };\n\n    const handleShowAcceptButton = () => {\n      initSwapData();\n      initMainPage();\n      initRateFrom();\n\n      if (strName.ua_cnt === 0) {\n        return;\n      }\n\n      dialogUnacceptedVisible.value = true;\n    };\n\n    const handleShowRateButton = () => {\n      initSwapData();\n      initMainPage();\n      initRateFrom();\n      dialogUnratedVisible.value = true;\n    };\n\n    const handleAccept = async data => {\n      const res = await acceptSwap(data.swapID);\n      const phoneStr = res.phone_number === null ? '<p> No phone number available</p>' : 'Phone Number is: ' + res.phone_number + ' (' + res.phone_type + ')';\n      const outs = '<p>Contact the proposer to swap items!\\n<p>' + '<br>' + `<p>Email: ${res.email}<p>` + '<br>' + `<p>Name: ${res.first_name}<p>` + '<br>' + phoneStr;\n      await ElMessageBox.alert(outs, 'Swap Accepted', {\n        confirmButtonText: 'OK',\n        dangerouslyUseHTMLString: true,\n        callback: async action => {\n          ElMessage({\n            type: 'info',\n            message: 'this form has been reset'\n          });\n          await initSwapData();\n          await initMainPage();\n          await initRateFrom();\n        }\n      });\n\n      if (swapData.value.length === 0) {\n        ElMessage({\n          type: 'info',\n          message: 'no more swaps need to accept/reject '\n        });\n        dialogUnacceptedVisible.value = false;\n      }\n    };\n\n    const handleReject = async data => {\n      const res = await rejectSwap(data.swapID);\n      console.log(res);\n      await initSwapData();\n      await initMainPage();\n      await initRateFrom();\n\n      if (swapData.value.length === 0) {\n        ElMessage({\n          type: 'info',\n          message: 'no more swaps need to accept/reject '\n        });\n        dialogUnacceptedVisible.value = false;\n      }\n    };\n\n    const handleRate = async row => {\n      console.log(row);\n      rateSwap({\n        email: localStorage.getItem('token'),\n        rating: rateValue.value[row.swapID],\n        swapID: row.swapID\n      });\n      ElMessage({\n        type: 'info',\n        message: 'rated, reset the form'\n      });\n      await initSwapData();\n      await initMainPage();\n      await initRateFrom();\n\n      if (rateData.value.length === 0) {\n        ElMessage({\n          type: 'info',\n          message: 'no more swaps need to rate '\n        });\n        dialogUnratedVisible.value = false;\n      }\n    };\n\n    const desiredDetailData = ref([]);\n    const proposedDetailData = ref([]);\n    const desiredDetailVisible = ref(false);\n    const proposedDetailVisible = ref(false);\n\n    const handleDetailDesired = async data => {\n      // console.log(data)\n      const x = await itemDetail(data.row.desired_itemID, localStorage.getItem('token'));\n      console.log(x);\n      desiredDetailVisible.value = true;\n      desiredDetailData.value.itemID = x.itemID;\n      desiredDetailData.value.title = x.title;\n      desiredDetailData.value.game_type = x.game_type;\n      desiredDetailData.value.v_platform = x.v_platform;\n      desiredDetailData.value.description = x.description;\n      desiredDetailData.value.condition = x.condition;\n      desiredDetailData.value.media = x.media;\n      desiredDetailData.value.c_platform = x.c_platform;\n      desiredDetailData.value.piece = x.piece;\n      desiredDetailData.value.nickname = x.nickname;\n      desiredDetailData.value.postal_code = x.postal_code;\n      desiredDetailData.value.state = x.state;\n      desiredDetailData.value.city = x.city;\n      desiredDetailData.value.rating = x.rating;\n      desiredDetailData.value.distance = x.distance;\n    };\n\n    const handleDetailProposed = async data => {\n      // console.log(data)\n      const x = await itemDetail(data.row.proposed_itemID, localStorage.getItem('token'));\n      console.log(x);\n      proposedDetailVisible.value = true;\n      proposedDetailData.value.itemID = x.itemID;\n      proposedDetailData.value.title = x.title;\n      proposedDetailData.value.game_type = x.game_type;\n      proposedDetailData.value.v_platform = x.v_platform;\n      proposedDetailData.value.description = x.description;\n      proposedDetailData.value.condition = x.condition;\n      proposedDetailData.value.media = x.media;\n      proposedDetailData.value.c_platform = x.c_platform;\n      proposedDetailData.value.piece = x.piece;\n      proposedDetailData.value.nickname = x.nickname;\n      proposedDetailData.value.postal_code = x.postal_code;\n      proposedDetailData.value.state = x.state;\n      proposedDetailData.value.city = x.city;\n      proposedDetailData.value.rating = x.rating;\n      proposedDetailData.value.distance = x.distance;\n    };\n\n    const warningAOR = () => {\n      const uaDataMTFiveCnt = strName.value.uaDateMTFiveCnt;\n      const ua_cnt = strName.value.ua_cnt;\n      let x = null;\n      let y = null;\n\n      if (uaDataMTFiveCnt > 0 || ua_cnt > 5) {\n        x = 'red';\n        y = 'bold';\n      }\n\n      return {\n        color: x\n      };\n    };\n\n    const setDistanceStyle = () => {\n      const distance = proposedDetailData.value.distance;\n      console.log('distance is : ' + distance);\n      let x = null;\n\n      if (distance === 0) {\n        x = 'white';\n      }\n\n      if (distance > 0 && distance <= 25.0) {\n        x = 'green';\n      }\n\n      if (distance > 25.0 && distance <= 50) {\n        x = 'yellow';\n      }\n\n      if (distance > 50.0 && distance <= 100.0) {\n        x = 'orange';\n      }\n\n      if (distance > 100.0) {\n        x = 'red';\n      }\n\n      console.log('color is : ' + x);\n      return {\n        background: x\n      };\n    };\n\n    const __returned__ = {\n      strName,\n      swapData,\n      rateData,\n      dialogUnacceptedVisible,\n      dialogUnratedVisible,\n      initMainPage,\n      initSwapData,\n      rateValue,\n      initRateFrom,\n      handleShowAcceptButton,\n      handleShowRateButton,\n      handleAccept,\n      handleReject,\n      handleRate,\n      desiredDetailData,\n      proposedDetailData,\n      desiredDetailVisible,\n      proposedDetailVisible,\n      handleDetailDesired,\n      handleDetailProposed,\n      warningAOR,\n      setDistanceStyle,\n      Check,\n      Close,\n      computed,\n      onBeforeMount,\n      onMounted,\n      ref,\n      mainPage,\n      ElDialog,\n      ElMessage,\n      ElMessageBox,\n      aorSwapForm,\n      acceptSwap,\n      rateSwapForm,\n      rateSwap,\n      router,\n      rejectSwap,\n      itemDetail\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n\n};","map":{"version":3,"mappings":"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","names":["Check","Close","computed","onBeforeMount","onMounted","ref","mainPage","ElDialog","ElMessage","ElMessageBox","aorSwapForm","acceptSwap","rateSwapForm","rateSwap","router","rejectSwap","itemDetail","strName","swapData","rateData","dialogUnacceptedVisible","dialogUnratedVisible","initMainPage","x","localStorage","getItem","value","initSwapData","console","log","rateValue","initRateFrom","res","handleShowAcceptButton","ua_cnt","handleShowRateButton","handleAccept","data","swapID","phoneStr","phone_number","phone_type","outs","email","first_name","alert","confirmButtonText","dangerouslyUseHTMLString","callback","action","type","message","length","handleReject","handleRate","row","rating","desiredDetailData","proposedDetailData","desiredDetailVisible","proposedDetailVisible","handleDetailDesired","desired_itemID","itemID","title","game_type","v_platform","description","condition","media","c_platform","piece","nickname","postal_code","state","city","distance","handleDetailProposed","proposed_itemID","warningAOR","uaDataMTFiveCnt","uaDateMTFiveCnt","y","color","setDistanceStyle","background"],"sources":["/Users/alzhong/Personal/Projects/FamilyCareInventory/frontend/src/views/MainView/MainPageView/MainPageView.vue"],"sourcesContent":["<template>\n  <div class=\"page-title\">\n    <h1>GameSwap</h1>\n    <hr style=\"width:50%;text-align:left;margin-left:0\">\n  </div>\n  <div class=\"welcome-title\">\n    <h1> Welcome, {{ strName.name }} !</h1>\n  </div>\n  <div class=\"status-section\">\n    <h1> My Rating: {{ strName.rating }} </h1>\n    <a> Unaccepted Swaps: </a>\n    <span\n        @click=\"handleShowAcceptButton\"\n        style=\"text-decoration:underline;\"\n    >\n    <a v-if=\"strName.uaDateMTFiveCnt>0||strName.ua_cnt>5\" style=\"color:red;\"><b>{{ strName.ua_cnt }}</b></a>\n    <a v-else>{{ strName.ua_cnt }}</a>\n    </span>\n    <!--    <el-button >show Unaccepted</el-button>-->\n    <br>\n    <a> Unrated Swaps: </a>\n    <span\n        @click=\"handleShowRateButton\"\n        style=\"text-decoration:underline;\"\n    >\n    <a v-if=\"strName.ur_cnt>2\" style=\"color:red;\"><b>{{ strName.ur_cnt }}</b></a>\n    <a v-else>{{ strName.ur_cnt }}</a>\n    </span>\n    <!-- <el-button @click=\"handleShowRateButton\">show Unrated</el-button>-->\n  </div>\n  <el-dialog\n      v-model=\"dialogUnacceptedVisible\"\n      title=\"Unaccepted\"\n      @open=\"initSwapData\"\n      style=\"width: 80%\"\n  >\n    <el-dialog\n        v-model=\"desiredDetailVisible\"\n        width=\"70%\"\n        append-to-body\n        top\n    >\n      <el-descriptions title=\"Item Detail\" :column=\"1\">\n        <el-descriptions-item label=\"Item #:\">{{ desiredDetailData.itemID }}</el-descriptions-item>\n        <el-descriptions-item label=\"Title:\">{{ desiredDetailData.title }}</el-descriptions-item>\n        <el-descriptions-item label=\"Game type:\">{{ desiredDetailData.game_type }}</el-descriptions-item>\n        <el-descriptions-item label=\"Condition:\">{{ desiredDetailData.condition }}</el-descriptions-item>\n        <el-descriptions-item label=\"Description:\" v-if=\"desiredDetailData.description.length>0\">{{ desiredDetailData.description }}</el-descriptions-item>\n        <el-descriptions-item label=\"Console Platform:\" v-if=\"desiredDetailData.game_type === 'Video game'\">{{ desiredDetailData.v_platform }}</el-descriptions-item>\n        <el-descriptions-item label=\"Media:\" v-if=\"desiredDetailData.game_type === 'Video game'\">{{ desiredDetailData.media }}</el-descriptions-item>\n        <el-descriptions-item label=\"Computer System Platform:\" v-if=\"desiredDetailData.game_type === 'Computer game'\">{{ desiredDetailData.c_platform }}</el-descriptions-item>\n        <el-descriptions-item label=\"Jigsaw Pieces Number:\" v-if=\"desiredDetailData.game_type === 'Jigsaw puzzle'\">{{ desiredDetailData.piece }}</el-descriptions-item>\n        <el-descriptions-item label=\"Offer by:\">{{ desiredDetailData.nickname }}</el-descriptions-item>\n        <el-descriptions-item label=\"Location:\">{{ desiredDetailData.city }}, {{ desiredDetailData.state }} {{ desiredDetailData.postal_code}}</el-descriptions-item>\n        <el-descriptions-item label=\"Rating:\">{{ desiredDetailData.rating }}</el-descriptions-item>\n        <el-descriptions-item label=\"Distance:\">{{ desiredDetailData.distance.toFixed(1) }} miles</el-descriptions-item>\n      </el-descriptions>\n    </el-dialog>\n    <el-dialog\n        v-model=\"proposedDetailVisible\"\n        width=\"70%\"\n        append-to-body\n        top\n    >\n      <el-descriptions title=\"Item Detail\" :column=\"1\">\n        <el-descriptions-item label=\"Item #:\">{{ proposedDetailData.itemID }}</el-descriptions-item>\n        <el-descriptions-item label=\"Title:\">{{ proposedDetailData.title }}</el-descriptions-item>\n        <el-descriptions-item label=\"Game type:\">{{ proposedDetailData.game_type }}</el-descriptions-item>\n        <el-descriptions-item label=\"Condition:\">{{ proposedDetailData.condition }}</el-descriptions-item>\n        <el-descriptions-item label=\"Description:\" v-if=\"proposedDetailData.description.length>0\">{{ proposedDetailData.description }}</el-descriptions-item>\n        <el-descriptions-item label=\"Console Platform:\" v-if=\"proposedDetailData.game_type === 'Video game'\">{{ proposedDetailData.v_platform }}</el-descriptions-item>\n        <el-descriptions-item label=\"Media:\" v-if=\"proposedDetailData.game_type === 'Video game'\">{{ proposedDetailData.media }}</el-descriptions-item>\n        <el-descriptions-item label=\"Computer System Platform:\" v-if=\"proposedDetailData.game_type === 'Computer game'\">{{ proposedDetailData.c_platform }}</el-descriptions-item>\n        <el-descriptions-item label=\"Jigsaw Pieces Number:\" v-if=\"proposedDetailData.game_type === 'Jigsaw puzzle'\">{{ proposedDetailData.piece }}</el-descriptions-item>\n        <el-descriptions-item label=\"Offer by:\">{{ proposedDetailData.nickname }}</el-descriptions-item>\n        <el-descriptions-item label=\"Location:\">{{ proposedDetailData.city }}, {{ proposedDetailData.state }} {{ proposedDetailData.postal_code}}</el-descriptions-item>\n        <el-descriptions-item label=\"Rating:\">{{ proposedDetailData.rating }}</el-descriptions-item>\n        <el-descriptions-item label=\"Distance:\">\n            <span :style=\"setDistanceStyle()\">\n              {{ proposedDetailData.distance.toFixed(1) }} miles\n            </span>\n        </el-descriptions-item>\n      </el-descriptions>\n    </el-dialog>\n    <el-table :data=\"swapData\" style=\"width: 1000%\" table-layout: auto>\n      <el-table-column fixed type=\"index\" width=\"50\"/>\n      <el-table-column prop=\"proposed_date\" label=\"Date\" width=\"100\"/>\n      <el-table-column prop=\"desired_item_title\" label=\"Desired Item\" width=\"170%\">\n        <template #default=\"scope\">\n          <el-button type=\"text\"  @click=\"handleDetailDesired(scope)\"\n          >{{ scope.row.desired_item_title }}\n          </el-button>\n        </template>\n      </el-table-column>\n      <el-table-column prop=\"proposer_nickname\" label=\"Proposer\" width=\"120\"/>\n      <el-table-column prop=\"distance\" label=\"Distance\" width=\"100\">\n        <template #default=\"scope\">\n          <a>\n            {{scope.row.distance.toFixed(1)}} miles\n          </a>\n        </template>\n      </el-table-column>\n      <el-table-column prop=\"rating\" label=\"Rating\" width=\"80\"/>\n      <el-table-column prop=\"proposed_item_title\" label=\"Proposed Item\" width=\"170%\">\n        <template #default=\"scope\">\n          <el-button type=\"text\"  @click=\"handleDetailProposed(scope)\"\n          >{{ scope.row.proposed_item_title }}\n          </el-button>\n        </template>\n      </el-table-column>\n      <el-table-column fixed=\"right\" label=\"Actions\">\n        <template #default=\"{ row }\">\n          <el-button-group class=\"ml-4\">\n            <el-button type=\"primary\" :icon=\"Check\" @click=\"handleAccept(row)\"/>\n            <el-button type=\"primary\" :icon=\"Close\" @click=\"handleReject(row)\"/>\n          </el-button-group>\n        </template>\n      </el-table-column>\n    </el-table>\n  </el-dialog>\n  <el-dialog\n      v-model=\"dialogUnratedVisible\"\n      title=\"Unrated\"\n      @open='initRateFrom'\n  >\n    <el-table :data=\"rateData\" style=\"width: 100%\" table-layout: auto>\n      <el-table-column fixed type=\"index\" width=\"50\"/>\n      <el-table-column prop=\"swapID\" label=\"Swap ID\"/>\n      <el-table-column prop=\"acceptance_date\" label=\"Acceptance Date\"/>\n      <el-table-column prop=\"my_role\" label=\"My Role\"/>\n      <el-table-column prop=\"proposed_item_name\" label=\"Proposed Item\" width=\"150%\"/>\n      <el-table-column prop=\"desired_item_name\" label=\"Desired Item\"/>\n      <el-table-column prop=\"other_user_nickname\" label=\"Other's Nick Name\"/>\n      <el-table-column fixed=\"right\" label=\"Actions\">\n        <template #default=\"{ row }\">\n          <el-select v-model=\"rateValue[row.swapID]\" class=\"m-2\" placeholder=\"Select\" size=\"small\"\n                     @change=\"handleRate(row)\">\n            <el-option label=\"0\" value=0></el-option>\n            <el-option label=\"1\" value=1></el-option>\n            <el-option label=\"2\" value=2></el-option>\n            <el-option label=\"3\" value=3></el-option>\n            <el-option label=\"4\" value=4></el-option>\n            <el-option label=\"5\" value=5></el-option>\n          </el-select>\n        </template>\n      </el-table-column>\n    </el-table>\n  </el-dialog>\n</template>\n\n<script setup>\nimport {\n  Check, Close\n} from '@element-plus/icons-vue'\n/* eslint-disable */\nimport { computed, onBeforeMount, onMounted, ref } from 'vue'\n// import { useStore } from 'vuex'\nimport { mainPage } from '@/api/main_page'\nimport { ElDialog, ElMessage, ElMessageBox } from 'element-plus'\nimport { aorSwapForm } from '@/api/aorSwapForm'\nimport { acceptSwap } from '@/api/acceptSwap'\nimport { rateSwapForm } from '@/api/rateSwapForm'\nimport { rateSwap } from '@/api/rateSwap'\nimport router from '@/router'\nimport { rejectSwap } from '@/api/rejectSwap'\nimport { itemDetail } from '@/api/itemDetail'\n// const store = useStore()\nconst strName = ref('')\nconst swapData = ref([])\nconst rateData = ref([])\nlet dialogUnacceptedVisible = ref(false)\nlet dialogUnratedVisible = ref(false)\nonMounted(async () => {\n  await initMainPage()\n})\nconst initMainPage = async () => {\n  let x = await mainPage(localStorage.getItem('token'))\n  strName.value = x\n\n}\nconst initSwapData = async () => {\n  swapData.value = []\n  swapData.value = await aorSwapForm(localStorage.getItem('token'))\n  // console.log('swap data len is' + swapData.value.length)\n  console.log(swapData.value)\n}\nconst rateValue = ref([])\nconst initRateFrom = async () => {\n  const res = await rateSwapForm(localStorage.getItem('token'))\n  rateValue.value = []\n  rateData.value = res\n}\nconst handleShowAcceptButton = () => {\n  initSwapData()\n  initMainPage()\n  initRateFrom()\n  if (strName.ua_cnt===0){\n    return\n  }\n  dialogUnacceptedVisible.value = true\n}\nconst handleShowRateButton = () => {\n  initSwapData()\n  initMainPage()\n  initRateFrom()\n  dialogUnratedVisible.value = true\n}\nconst handleAccept = async (data) => {\n  const res = await acceptSwap(data.swapID)\n  const phoneStr = res.phone_number === null ? '<p> No phone number available</p>' : 'Phone Number is: ' + res.phone_number + ' (' + res.phone_type + ')'\n  const outs = '<p>Contact the proposer to swap items!\\n<p>' + '<br>' +\n      `<p>Email: ${res.email}<p>` + '<br>' +\n      `<p>Name: ${res.first_name}<p>` + '<br>' + phoneStr\n  await ElMessageBox.alert(outs, 'Swap Accepted', {\n    confirmButtonText: 'OK',\n    dangerouslyUseHTMLString: true,\n    callback: async (action) => {\n      ElMessage({\n        type: 'info',\n        message: 'this form has been reset'\n      })\n      await initSwapData()\n      await initMainPage()\n      await initRateFrom()\n    }\n  })\n\n  if (swapData.value.length === 0) {\n    ElMessage({\n      type: 'info',\n      message: 'no more swaps need to accept/reject '\n    })\n    dialogUnacceptedVisible.value = false\n  }\n}\nconst handleReject = async (data) => {\n  const res = await rejectSwap((data.swapID))\n  console.log(res)\n  await initSwapData()\n  await initMainPage()\n  await initRateFrom()\n  if (swapData.value.length === 0) {\n    ElMessage({\n      type: 'info',\n      message: 'no more swaps need to accept/reject '\n    })\n    dialogUnacceptedVisible.value = false\n  }\n}\n\nconst handleRate = async (row) => {\n  console.log(row)\n  rateSwap({\n    email: localStorage.getItem('token'),\n    rating: rateValue.value[row.swapID],\n    swapID: row.swapID\n  })\n  ElMessage({\n    type: 'info',\n    message: 'rated, reset the form'\n  })\n  await initSwapData()\n  await initMainPage()\n  await initRateFrom()\n  if (rateData.value.length === 0) {\n    ElMessage({\n      type: 'info',\n      message: 'no more swaps need to rate '\n    })\n    dialogUnratedVisible.value = false\n  }\n}\nconst desiredDetailData = ref([])\nconst proposedDetailData = ref([])\nconst desiredDetailVisible = ref(false)\nconst proposedDetailVisible = ref(false)\nconst handleDetailDesired = async (data) => {\n  // console.log(data)\n  const x = await itemDetail(data.row.desired_itemID, localStorage.getItem('token'))\n  console.log(x)\n  desiredDetailVisible.value = true\n  desiredDetailData.value.itemID = x.itemID\n  desiredDetailData.value.title = x.title\n  desiredDetailData.value.game_type = x.game_type\n  desiredDetailData.value.v_platform = x.v_platform\n  desiredDetailData.value.description = x.description\n  desiredDetailData.value.condition = x.condition\n  desiredDetailData.value.media = x.media\n  desiredDetailData.value.c_platform = x.c_platform\n  desiredDetailData.value.piece = x.piece\n  desiredDetailData.value.nickname = x.nickname\n  desiredDetailData.value.postal_code = x.postal_code\n  desiredDetailData.value.state = x.state\n  desiredDetailData.value.city = x.city\n  desiredDetailData.value.rating = x.rating\n  desiredDetailData.value.distance = x.distance\n}\nconst handleDetailProposed = async (data) => {\n  // console.log(data)\n  const x = await itemDetail(data.row.proposed_itemID, localStorage.getItem('token'))\n  console.log(x)\n  proposedDetailVisible.value = true\n  proposedDetailData.value.itemID = x.itemID\n  proposedDetailData.value.title = x.title\n  proposedDetailData.value.game_type = x.game_type\n  proposedDetailData.value.v_platform = x.v_platform\n  proposedDetailData.value.description = x.description\n  proposedDetailData.value.condition = x.condition\n  proposedDetailData.value.media = x.media\n  proposedDetailData.value.c_platform = x.c_platform\n  proposedDetailData.value.piece = x.piece\n  proposedDetailData.value.nickname = x.nickname\n  proposedDetailData.value.postal_code = x.postal_code\n  proposedDetailData.value.state = x.state\n  proposedDetailData.value.city = x.city\n  proposedDetailData.value.rating = x.rating\n  proposedDetailData.value.distance = x.distance\n}\nconst  warningAOR = () => {\n  const uaDataMTFiveCnt = strName.value.uaDateMTFiveCnt\n  const ua_cnt = strName.value.ua_cnt\n  let x = null\n  let y = null\n  if (uaDataMTFiveCnt > 0 || ua_cnt > 5) {\n    x = 'red'\n    y = 'bold'\n  }\n  return {\n    color: x\n  }\n}\nconst setDistanceStyle = () => {\n  const distance = proposedDetailData.value.distance\n  console.log('distance is : ' + distance)\n  let x = null\n  if (distance === 0) {\n    x = 'white'\n  }\n  if (distance > 0 && distance <= 25.0) {\n    x = 'green'\n  }\n  if (distance > 25.0 && distance <= 50) {\n    x = 'yellow'\n  }\n  if (distance > 50.0 && distance <= 100.0) {\n    x = 'orange'\n  }\n  if (distance > 100.0) {\n    x = 'red'\n  }\n  console.log('color is : ' + x)\n  return {\n    background: x\n  }\n}\n</script>\n\n<style lang=\"scss\" scoped>\n$bg: #2d3a4b;\n$dark_gray: #889aa4;\n$light_gray: #eee;\n$cursor: #fff;\n\n\n.page-title {\n  font-size: 30px;\n  text-align: left;\n  margin-left: 300px;\n  margin-bottom: 20px;\n}\n\n.welcome-title {\n  font-size: 16px;\n  text-align: left;\n  margin-left: 300px;\n  margin-bottom: 20px;\n}\n\n.status-section {\n  font-size: 16px;\n  text-align: center;\n  margin-left: 350px;\n  margin-bottom: 20px;\n  width: 300px;\n  height: 200px;\n  border: solid black 1px;\n  padding: 35px;\n\n}\n\n.title-section {\n  font-size: 30px;;\n  width: 500px;\n  margin-left: 50px;\n}\n</style>\n"]},"metadata":{},"sourceType":"module"}
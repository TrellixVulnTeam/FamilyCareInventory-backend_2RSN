{"ast":null,"code":"import { onMounted, ref } from 'vue';\nimport { useStore } from 'vuex';\nimport { myCosts } from '@/api/myCost';\nimport { deleteCost } from \"@/api/deleteCost\";\nimport { addCost } from \"@/api/addCost\"; // eslint-disable-next-line\n\nimport { ElMessage, ElMessageBox } from 'element-plus';\nexport default {\n  setup(__props, {\n    expose\n  }) {\n    expose();\n    const rules = ref({\n      name: [{\n        required: true,\n        message: '请输入费用名称',\n        trigger: 'blur'\n      }],\n      amt: [{\n        required: true,\n        message: '请输入费用金额',\n        trigger: 'blur'\n      }],\n      cost_time: [{\n        required: true,\n        message: '请输入日期',\n        trigger: 'blur'\n      }]\n    });\n    const form = ref({\n      name: '',\n      amt: '',\n      cost_time: '',\n      note: ''\n    });\n\n    const initCostData = async () => {\n      costsData.value = [];\n      costsData.value = await myCosts(localStorage.getItem('token'));\n    }; // listItem\n    // eslint-disable-next-line\n\n\n    const store = useStore();\n    const costsData = ref([]);\n    onMounted(async () => {\n      const y = await myCosts(localStorage.getItem('token'));\n      costsData.value = y;\n    });\n\n    const handleAdd = async () => {\n      // console.log(form)\n      // store.dispatch('app/listItem', form.value)\n      addCost(form.value, localStorage.getItem('token')).then(() => {\n        // console.log('get returned' + res)\n        ElMessageBox.alert('提交成功！', {\n          confirmButtonText: 'OK',\n          callback: () => {\n            setTimeout(initCostData, 1);\n            form.value = {\n              name: '',\n              amt: '',\n              cost_time: '',\n              note: ''\n            };\n            ElMessage({\n              type: 'info',\n              message: '已更新列表'\n            });\n          }\n        });\n      }).catch(err => {\n        alert(err);\n      });\n    };\n\n    const resetForm = async () => {\n      form.value = {\n        name: '',\n        amt: '',\n        cost_time: '',\n        note: ''\n      };\n    };\n\n    const handleDeleteCost = async row => {\n      console.log(row);\n      deleteCost({\n        token: localStorage.getItem('token'),\n        costId: row.costId\n      });\n      ElMessage({\n        type: 'info',\n        message: '已删除'\n      });\n      setTimeout(initCostData, 1);\n    };\n\n    const focusOnNextItem = nextItemId => {\n      var nextItem = document.getElementById(nextItemId);\n      nextItem.focus();\n    };\n\n    const __returned__ = {\n      rules,\n      form,\n      initCostData,\n      store,\n      costsData,\n      handleAdd,\n      resetForm,\n      handleDeleteCost,\n      focusOnNextItem,\n      onMounted,\n      ref,\n      useStore,\n      myCosts,\n      deleteCost,\n      addCost,\n      ElMessage,\n      ElMessageBox\n    };\n    Object.defineProperty(__returned__, '__isScriptSetup', {\n      enumerable: false,\n      value: true\n    });\n    return __returned__;\n  }\n\n};","map":{"version":3,"mappings":"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","names":["onMounted","ref","useStore","myCosts","deleteCost","addCost","ElMessage","ElMessageBox","rules","name","required","message","trigger","amt","cost_time","form","note","initCostData","costsData","value","localStorage","getItem","store","y","handleAdd","then","alert","confirmButtonText","callback","setTimeout","type","catch","err","resetForm","handleDeleteCost","row","console","log","token","costId","focusOnNextItem","nextItemId","nextItem","document","getElementById","focus"],"sources":["/Users/alzhong/Personal/Projects/FamilyCareInventory/frontend/src/views/MainView/CostView/CostView.vue"],"sourcesContent":["<template>\n  <div class=\"page-title\">\n    <h1>添加费用</h1>\n    <hr style=\"width:50%;text-align:left;margin-left:0\">\n  </div>\n  <div class=\"list-form\">\n    <el-form :model=\"form\" label-width=\"100px\" :rules=\"rules\">\n      <el-form-item label=\"费用名称\" prop=\"name\" >\n        <el-input class=\"item-input\" size=\"large\" v-model=\"form.name\" @keyup.enter=\"focusOnNextItem('amt')\"/>\n      </el-form-item>\n      <el-form-item label=\"费用金额\" prop=\"amt\" >\n        <el-input class=\"item-input\" size=\"large\" v-model=\"form.amt\" id=\"amt\" @keyup.enter=\"focusOnNextItem('ct')\"/>\n      </el-form-item>\n      <el-form-item label=\"日期\" prop=\"cost_time\" >\n        <el-date-picker\n            type=\"date\" placeholder=\"选择日期\" v-model=\"form.cost_time\" id=\"ct\" @keyup.enter=\"focusOnNextItem('note')\">\n        </el-date-picker>\n      </el-form-item>\n      <el-form-item label=\"备注\" prop=\"note\">\n        <el-input class=\"item-input\" size=\"large\" v-model=\"form.note\" type=\"textarea\" id=\"note\" @keyup.enter=\"handleAdd\"/>\n      </el-form-item>\n      <el-form-item>\n        <el-button type=\"primary\" @click=\"handleAdd\" class=\"item-button\">提交</el-button>\n        <el-button @click=\"resetForm\" class=\"item-button\">重置</el-button>\n      </el-form-item>\n    </el-form>\n  </div>\n  <br/>\n  <br/>\n  <br/>\n  <div class=\"page-title\">\n    <h1>费用明细</h1>\n    <hr style=\"width:50%;text-align:left;margin-left:0\">\n  </div>\n\n  <div class=\"items-container\">\n    <el-table :data=\"costsData\" style=\"width: 100%\" table-layout: auto>\n      <el-table-column prop=\"name\" label=\"费用名称\"/>\n      <el-table-column prop=\"amt\" label=\"费用金额\"/>\n      <el-table-column prop=\"cost_time\" label=\"日期\"/>\n      <el-table-column prop=\"note\" label=\"备注\"/>\n      <el-table-column fixed=\"right\" label=\"操作\">\n        <template #default=\"{ row }\">\n          <el-select v-model=\"costsData[row.productId]\" class=\"m-2\" placeholder=\"Select\" size=\"small\"\n                     @change=\"handleDeleteCost(row)\">\n            <el-option label=\"删除\" value=0></el-option>\n          </el-select>\n        </template>\n      </el-table-column>\n    </el-table>\n  </div>\n</template>\n\n<script setup>\nimport { onMounted, ref } from 'vue'\nimport { useStore } from 'vuex'\nimport { myCosts } from '@/api/myCost'\nimport { deleteCost } from \"@/api/deleteCost\";\nimport { addCost } from \"@/api/addCost\";\n// eslint-disable-next-line\nimport { ElMessage, ElMessageBox } from 'element-plus'\nconst rules = ref({\n  name: [\n    {\n      required: true,\n      message: '请输入费用名称',\n      trigger: 'blur'\n    }\n  ],\n  amt: [\n    {\n      required: true,\n      message: '请输入费用金额',\n      trigger: 'blur'\n    }\n  ],\n  cost_time: [\n    {\n      required: true,\n      message: '请输入日期',\n      trigger: 'blur'\n    }\n  ]\n})\n\nconst form = ref({\n  name: '',\n  amt: '',\n  cost_time: '',\n  note: ''\n})\nconst initCostData = async () => {\n  costsData.value = []\n  costsData.value = await myCosts(localStorage.getItem('token'))\n}\n\n// listItem\n// eslint-disable-next-line\nconst store = useStore()\nconst costsData = ref([])\nonMounted(async () => {\n  const y = await myCosts(localStorage.getItem('token'))\n  costsData.value = y\n})\nconst handleAdd = async () => {\n  // console.log(form)\n  // store.dispatch('app/listItem', form.value)\n  addCost(form.value, localStorage.getItem('token')).then(() => {\n    // console.log('get returned' + res)\n    ElMessageBox.alert('提交成功！', {\n      confirmButtonText: 'OK',\n      callback: () => {\n        setTimeout(initCostData, 1)\n        form.value = {\n          name: '',\n          amt: '',\n          cost_time: '',\n          note: ''\n        }\n        ElMessage({\n          type: 'info',\n          message: '已更新列表'\n        })\n      }\n    })\n  }).catch((err) => {\n    alert(err)\n  })\n}\n\nconst resetForm = async() => {\n  form.value = {\n    name: '',\n    amt: '',\n    cost_time: '',\n    note: ''\n  }\n}\nconst handleDeleteCost = async (row) => {\n  console.log(row)\n  deleteCost({\n    token: localStorage.getItem('token'),\n    costId: row.costId,\n  })\n  ElMessage({\n    type: 'info',\n    message: '已删除'\n  })\n  setTimeout(initCostData, 1)\n}\nconst focusOnNextItem = (nextItemId) => {\n  var nextItem = document.getElementById(nextItemId)\n  nextItem.focus()\n}\n</script>\n\n<style scoped lang=\"scss\">\n\n.list-form {\n  margin-left: 350px;\n}\n\n.item-input {\n  width: 400px;\n}\n\n.item-button {\n  margin-left: 10px;\n  margin-top: 20px;\n}\n\n.items-container {\n  margin-left: 300px;\n  width: 1000px;\n}\n\n.page-title {\n  font-size: 20px;\n  text-align: left;\n  margin-left: 300px;\n  margin-bottom: 20px;\n}\n</style>\n"]},"metadata":{},"sourceType":"module"}